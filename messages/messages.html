<html>
    <head>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
        <script>
            $(document).ready(function(){
                $(document).on('keypress',function(e) {
                if(e.which == 13) {
                    let message = $("#messageInput").val();
                    $("#messageInput").val('');
                    sendMessage(message);
                }
                });
            });

            //send entered message to the recipant
            function sendMessage(message){
                if(message != ""){
                    addMessage(message, true);
                    //insert ajax
                }
            }  
            //CHATBOX FUNCTIONS
            //add a message to the chat box
            function addMessage(message, isMyMessage){
                let html = ""
                if(isMyMessage){
                    html += "<div class = 'd-flex justify-content-end'>\
                    <span class = 'myMessage rounded-pill p-3'>" + message +"</span>"
                }
                else{
                    html += "<div class = 'd-flex justify-content-start'>\
                    <span class = 'thierMessage rounded-pill p-3'>" + message +"</span>"
                }
                html += "\<div>"
                $("#chatbox").append(html)
            }
            //clear chatbox
            function clearChatbox(){
                $("#chatbox").empty();
            }
            //SIDEBAR FUNCTIONS
            //clear contacts
            function clearContacts(){
                $("#contactsList").empty();
            };
            //load the lsit of direct messages
            function loadDirectContacts(){
                clearContacts();

            }
            //load the list of groups
            function loadGroupContacts(){

            }




        </script>

        <style>
            .container-fluid{
                padding: 0 !important;
            }
            .header{
                background-color: rgb(62, 0, 103);
            }
            h1{
                color:white;
            }
            .chatborder{
                background-color: rgb(62, 0, 103);
                border: white;
            }
            #messages{
                overflow-x: hidden !important;
                overflow-y: auto;
                background-color: white;
            }
            .myMessage{
                background-color: lightblue;
                align-self: self-end;
            }
            .thierMessage{
                background-color: grey;
            }
        </style>
    </head>
    
    <body class = "d-flex flex-column h-100" style = "background-color: white;">
        <header class = "header px-4 py-1 text-center">
            <h1> Message Subsystem </h1>
        </header>
        <div class="container-fluid d-flex flex-grow-1">
            <div class="row flex-grow-1 flex-column flex-sm-row g-0">
                <!-- chat selection-->
                <div class="col-sm-3 sidebar flex-shrink-1">
                    <div class="">
                        <!-- group and direct buttons-->
                        <div class="d-flex bd-highlight">
                            <div class="flex-fill bd-highlight text-center">
                                <button class="btn border border-white btn-primary rounded-0 w-100" onclick= "clearContacts()">
                                    Direct
                                </button>
                            </div>
                            <div class="flex-fill bd-highlight text-center">
                                <button class="btn border border-white btn-primary rounded-0 w-100" onclick= "clearContacts()">
                                    Group
                                </button>
                            </div>
                        </div>
                        <!-- list of chats-->
                        <div class = "text-center">
                        <ol id = "contactsList" class="list-group list-group rounded-0">
                            <li class="list-group-item d-flex justify-content-between align-items-start p-3">
                              <div class="ms-2 me-auto">
                                <div class="fw-bold">Jim Moriarty</div>
                              </div>
                              <!-- <span class="badge bg-primary rounded-pill">0</span> -->
                            </li>
                            <li class="list-group-item d-flex justify-content-between align-items-start p-3">
                              <div class="ms-2 me-auto">
                                <div class="fw-bold">Sherlock Homes</div>
                              </div>
                              <span class="badge bg-primary rounded-pill">2</span>
                            </li>
                            <li class="list-group-item d-flex justify-content-between align-items-start p-3">
                              <div class="ms-2 me-auto">
                                <div class="fw-bold">John Watson</div>
                              </div>
                              <span class="badge bg-primary rounded-pill">14</span>
                            </li>
                        </ol>
                        <button class="btn btn-success rounded-0 w-100">+</button>
                        </div>
                    </div>
                </div>
                <!-- chat -->
                <div id = "messages" class="col-sm-9 d-flex flex-column  p-4">
                    <div id = "chatbox" class = "d-flex flex-column">
                        <div class = "d-flex justify-content-end">
                            <span class = "myMessage rounded-pill p-3">HELLO</span>
                        </div>
                        <div class = "d-flex justify-content-start">
                            <span class = "thierMessage rounded-pill p-3">HELLO</span>
                        </div>
                        <div class = "d-flex justify-content-start">
                            <span class = "thierMessage rounded-pill p-3">HELLO</span>
                        </div>
                    </div>
                    <!-- message input-->
                    <div class = "row p-3" style = "margin-top:auto">
                        <input type="text" id ="messageInput" class = "p-3 m-0 rounded-pill" placeholder="enter Message">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
</body>
</html>